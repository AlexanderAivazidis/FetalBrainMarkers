---
output:
  html_document: default
  pdf_document: default
---
### Expression of cell type markers in fetal neocortex Nowakowski 2017 dataset

---
  title: "Expression of cell type markers and genes associated with regional brain volume in fetal neocortex"
output:
  html_document: default
github_document: default
fig_width: 12
fig_height: 4 
---
  
```{r include = FALSE}
### Load data and packages
knitr::opts_chunk$set(fig.width=24, fig.height=8) 

```


```{r, include = FALSE, message = FALSE, warning = FALSE, cache = FALSE}
library(Seurat)
require(gplots)
require(ComplexHeatmap)
require(ggplot2)
require(readxl)
library("dplyr")
require(ComplexHeatmap)
```

We will use the Nowakowski 2017 data to check read counts in each cell type for many marker genes including HOPX (oRG), EOMES (IP), STMN2 (Neurons), PDGFRA (OPCs):

```{r, include = TRUE, message = FALSE, warning = FALSE, cache = FALSE}

markerGenes = c('HOPX', 'EOMES', 'STMN2', 'PDGFRA', 'TBR1', 'PAX6', 'TNC', 'SOX2', 'FAM107A', 'BCL11B', 'SATB2')
setwd('/home/jovyan/FetalBrainMarkers/')
raw_counts_mat = read.delim('../data/fetalBrain/Nowakowski/exprMatrix.tsv.gz', row.names = 1, sep = '\t')
metadata = read.delim('../data/fetalBrain/Nowakowski/meta.tsv')
raw_counts_mat = as.matrix(raw_counts_mat[,match(metadata$Cell, colnames(raw_counts_mat))])

```

```{r, include = TRUE, message = FALSE, warning = FALSE, cache = FALSE, fig.height = 8, fig.width = 16}

df = data.frame(cluster = unlist(lapply(metadata$WGCNAcluster, function(x) strsplit(as.character(x), '-')[[1]][1])), HOPX = raw_counts_mat['HOPX', ], EOMES = raw_counts_mat['EOMES', ], STMN2 = raw_counts_mat['STMN2', ], PDGFRA = raw_counts_mat['PDGFRA',], TBR1 = raw_counts_mat['TBR1', ], PAX6 = raw_counts_mat['PAX6', ], TNC = raw_counts_mat['TNC', ], SOX2 = raw_counts_mat['SOX2', ], FAM107A = raw_counts_mat['FAM107A',], BCL11B = raw_counts_mat['BCL11B', ], SATB2 = raw_counts_mat['SATB2', ])

for (i in 1:length(markerGenes)){
  print(ggplot(df, aes(x=cluster, y=get(markerGenes[i]))) + geom_jitter(size = 0.01) + 
  stat_summary(fun.data=mean_sdl, fun.args = list(mult=1), geom="pointrange", color="red") + 
  ylab(paste(markerGenes[i], 'Read Count', sep = ' ')) +
  xlab(NULL) + 
  ggtitle(paste(markerGenes[i], 'Expression across Celltypes', sep = ' ')) + 
  theme(axis.text=element_text(size=12)))
}

```



